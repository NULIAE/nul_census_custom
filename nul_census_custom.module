<?php

/**
 * hook_node_view()
 */
function nul_census_custom_node_view($node, $view_mode, $langcode) {
  // If on census view mode run this js to fix up table styling
  if ($node->type == 'census') {
    drupal_add_js(drupal_get_path('module', 'nul_census_custom') . '/js/formFix.js');
  }
}

/**
 * hook_form_alter()
 */
function nul_census_custom_form_alter(&$form, &$form_state, $form_id) {
  if (!empty($form['#node']->type) && $form['#node']->type == 'census') {
    // float save to the bottom 
    if (!empty($form['#node_edit_form']) && $form['#node_edit_form'] == TRUE) {
      $form['actions']['#weight'] = 1000; 
    }
    // Add css file to style Census form in edit mode
    $form['#attached']['css'] = array(
      drupal_get_path('module', 'nul_census_custom') . '/css/editForm.css',
    );

    // make tooltips for all fields
    foreach ($form as $key => $value) {
      if (substr($key, 0, 6) == 'field_') {
        if (!empty($form[$key][LANGUAGE_NONE][0]['value']['#title'])) {
          $form[$key]['#attributes']['title'] = $form[$key][LANGUAGE_NONE][0]['value']['#title'];
        }
      }
    }
  }
}
